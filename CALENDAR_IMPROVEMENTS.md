# üóìÔ∏è –£–ª—É—á—à–µ–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ Telegram-–±–æ—Ç–µ

## üìã –ü—Ä–æ–±–ª–µ–º–∞

**–î–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π**: –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –¥–∞—Ç—ã –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–µ—Ä–∏–æ–¥–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—å –æ—Å—Ç–∞–≤–∞–ª—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–µ–ª, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞—á–∞–ª—Å—è, –∏ –º–æ–≥ –ø–æ–≤—Ç–æ—Ä–Ω–æ –Ω–∞–∂–∏–º–∞—Ç—å –Ω–∞ –¥–∞—Ç—É.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

**–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π**: –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å—Ä–∞–∑—É –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã –æ–∫–æ–Ω—á–∞–Ω–∏—è, –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –æ—Ç—á–µ—Ç–∞.

## üîÑ –ù–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

### 1. **–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å**
–°—Ä–∞–∑—É –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã –æ–∫–æ–Ω—á–∞–Ω–∏—è:
```
‚è≥ –§–æ—Ä–º–∏—Ä—É–µ–º –æ—Ç—á—ë—Ç...

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ, –∏–¥–µ—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥ 
01.07.2025 - 14.07.2025.
```

### 2. **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**
–ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç:
1. üìä –¢–µ–∫—Å—Ç–æ–≤—É—é —Å–≤–æ–¥–∫—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
2. üìà –ì—Ä–∞—Ñ–∏–∫ –¥–∏–Ω–∞–º–∏–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞  
3. üìä –ì—Ä–∞—Ñ–∏–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—Ç–∑—ã–≤–æ–≤
4. ü•ß –ö—Ä—É–≥–æ–≤—É—é –¥–∏–∞–≥—Ä–∞–º–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
5. üîô –ö–Ω–æ–ø–∫—É –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –í —Ñ–∞–π–ª–µ `telegram_bot.py`:

#### 1. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã –æ–∫–æ–Ω—á–∞–Ω–∏—è** (—Å—Ç—Ä–æ–∫–∏ 645-658)
```python
user_state['date_to'] = date_to.isoformat()
if user_state.get('action') == 'analytics':
    user_state['step'] = 'show_analytics'
    save_user_state(db, user_id, user_state)
    
    # –°—Ä–∞–∑—É –∑–∞–∫—Ä—ã—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    await query.edit_message_text(
        f"‚è≥ –§–æ—Ä–º–∏—Ä—É–µ–º –æ—Ç—á—ë—Ç...\n\n"
        f"–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ, –∏–¥–µ—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥ "
        f"{date_from.strftime('%d.%m.%Y')} - {date_to.strftime('%d.%m.%Y')}."
    )
    
    # –ü–æ–∫–∞–∑–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É
    await show_analytics_for_period(query, context)
```

#### 2. **–§—É–Ω–∫—Ü–∏—è `show_analytics_for_period`** (—Å—Ç—Ä–æ–∫–∏ 446-510)
- **–£–±—Ä–∞–Ω–æ**: –£—Å–ª–æ–≤–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- **–î–æ–±–∞–≤–ª–µ–Ω–æ**: –í—Å–µ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

**–ë—ã–ª–æ**:
```python
if is_callback:
    await update_or_query.edit_message_text(report['summary_text'])
else:
    await update_or_query.message.reply_text(report['summary_text'])
```

**–°—Ç–∞–ª–æ**:
```python
# –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–π —Å–≤–æ–¥–∫–∏ (–≤—Å–µ–≥–¥–∞ –∫–∞–∫ –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ)
await update_or_query.message.reply_text(report['summary_text'])
```

## üì± –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç

### –°—Ç–∞—Ä–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:
1. –í—ã–±–æ—Ä –¥–∞—Ç—ã –Ω–∞—á–∞–ª–∞ ‚úÖ
2. –í—ã–±–æ—Ä –¥–∞—Ç—ã –æ–∫–æ–Ω—á–∞–Ω–∏—è ‚úÖ
3. **–ö–∞–ª–µ–Ω–¥–∞—Ä—å –≤–∏—Å–∏—Ç** ‚ùå
4. **–ù–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏** ‚ùå
5. **–í–æ–∑–º–æ–∂–Ω—ã –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –Ω–∞–∂–∞—Ç–∏—è** ‚ùå
6. –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ ~10-30 —Å–µ–∫—É–Ω–¥ ‚úÖ

### –ù–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:
1. –í—ã–±–æ—Ä –¥–∞—Ç—ã –Ω–∞—á–∞–ª–∞ ‚úÖ
2. –í—ã–±–æ—Ä –¥–∞—Ç—ã –æ–∫–æ–Ω—á–∞–Ω–∏—è ‚úÖ
3. **–ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å—Ä–∞–∑—É –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è** ‚úÖ
4. **–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è** ‚úÖ
5. **–ü–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –∏–¥–µ—Ç** ‚úÖ
6. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–∏—Ö–æ–¥—è—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ ‚úÖ

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ ‚Üí `/start`
2. –ù–∞–∂–º–∏—Ç–µ "üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞"
3. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∏–ª–∏–∞–ª
4. –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –Ω–∞—á–∞–ª–∞
5. –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –æ–∫–æ–Ω—á–∞–Ω–∏—è
6. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ**: –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å—Ä–∞–∑—É –∑–∞–∫—Ä—ã–ª—Å—è
7. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ**: –ü–æ—è–≤–∏–ª–æ—Å—å —Å–æ–æ–±—â–µ–Ω–∏–µ "‚è≥ –§–æ—Ä–º–∏—Ä—É–µ–º –æ—Ç—á—ë—Ç..."
8. **–î–æ–∂–¥–∏—Ç–µ—Å—å**: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç:
```bash
source venv/bin/activate
python test_calendar_behavior.py
```

## ‚ö° –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- ‚úÖ **–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å** - –ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏–Ω—è—Ç–æ
- ‚úÖ **–ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤** - –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–∫—Ä—ã—Ç
- ‚úÖ **–ü—Ä–æ–≥—Ä–µ—Å—Å –≤–∏–¥–µ–Ω** - —è—Å–Ω–æ, —á—Ç–æ –∏–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞
- ‚úÖ **–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π UX** - –∫–∞–∫ –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö

### –î–ª—è —Å–∏—Å—Ç–µ–º—ã:
- ‚úÖ **–ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏** - –Ω–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ **–ß–µ—Ç–∫–∞—è –ª–æ–≥–∏–∫–∞** - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ **–õ—É—á—à–∞—è –æ—Ç–ª–∞–¥–∫–∞** - –ø—Ä–æ—â–µ –æ—Ç—Å–ª–µ–¥–∏—Ç—å —ç—Ç–∞–ø—ã

## üîÑ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- ‚úÖ **–§—É–Ω–∫—Ü–∏—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –æ—Ç–∑—ã–≤–æ–≤** –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å
- ‚úÖ **–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** —É–≤–∏–¥—è—Ç —É–ª—É—á—à–µ–Ω–∏—è —Å—Ä–∞–∑—É
- ‚úÖ **–ö–∞–ª–µ–Ω–¥–∞—Ä—å** —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –ø—Ä–µ–∂–¥–µ
- ‚úÖ **–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞**: –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ (–±—ã–ª–æ: 10-30 —Å–µ–∫)
- **–í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞**: –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (10-30 —Å–µ–∫)
- **–û–±—â–µ–µ –≤—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**: –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **–£–¥–æ–±—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**: –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–µ–Ω–æ

---

**–í–µ—Ä—Å–∏—è**: 2.9.1  
**–î–∞—Ç–∞**: 14.07.2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –∞–∫—Ç–∏–≤–Ω–æ