# CLAUDE.md - Reviews Parser API Documentation

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Ç–∑—ã–≤–æ–≤ —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã 2GIS –¥–ª—è —Å–µ—Ç–∏ —Ç–æ—á–µ–∫ –ø—Ä–æ–¥–∞–∂ "–°–∞–Ω–¥—ã–∫ –¢–∞—Ä—ã" –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è API –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–æ–±—Ä–∞–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã:

1. **Parser** (`parser.py`)
   - –ö–ª–∞—Å—Å `TwoGISReviewsParser` –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Ç–∑—ã–≤–æ–≤ —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω–æ–µ API 2GIS
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –∏ batch-–æ–±—Ä–∞–±–æ—Ç–∫–∏
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –∏–∑ –æ—Ç–∑—ã–≤–æ–≤
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ CSV –∏ JSON —Ñ–æ—Ä–º–∞—Ç—ã

2. **Branches Loader** (`branches_loader.py`) üÜï
   - –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Ñ–∏–ª–∏–∞–ª–æ–≤ –∏–∑ Google Sheets
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (TTL 5 –º–∏–Ω—É—Ç) –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - Graceful fallback –Ω–∞ CSV —Ñ–∞–π–ª –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Google Sheets
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Sheets API —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã: –ø–æ–∏—Å–∫ –ø–æ ID, –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –ø–æ iiko ID, —Å—á–µ—Ç—á–∏–∫ —Ñ–∏–ª–∏–∞–ª–æ–≤
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∞–ø–ø–∏–Ω–≥–∞ iiko ID ‚Üí branch_id –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

2–∞. **Branches Sync** (`sync_branches.py`) üÜï
   - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ñ–∏–ª–∏–∞–ª–æ–≤ –∏–∑ Google Sheets –≤ PostgreSQL –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ–∏–ª–∏–∞–ª–æ–≤ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö
   - **–ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥** –Ω–æ–≤—ã—Ö —Ñ–∏–ª–∏–∞–ª–æ–≤ –ø—Ä–∏ –∏—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∫—ç—à–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
   - –û—Ç–ø—Ä–∞–≤–∫–∞ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –æ—Ç–∑—ã–≤–æ–≤ –Ω–æ–≤—ã—Ö —Ñ–∏–ª–∏–∞–ª–æ–≤
   - –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

3. **Database** (`database.py`)
   - PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ø–æ—Ä—Ç—É 5436
   - SQLAlchemy ORM –º–æ–¥–µ–ª–∏
   - –¢—Ä–∏ —Ç–∞–±–ª–∏—Ü—ã: branches, reviews, parse_reports
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ JSON –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
   - –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

4. **API** (`api_v2.py`)
   - FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –ø–æ—Ä—Ç—É 8004
   - RESTful endpoints –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –≤ API –æ—Ç–≤–µ—Ç–∞—Ö
   - Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
   - CORS –ø–æ–¥–¥–µ—Ä–∂–∫–∞

5. **Migration** (`migrate_to_db.py`)
   - –°–∫—Ä–∏–ø—Ç –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV/JSON –≤ PostgreSQL
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –¥–∞—Ç
   - –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤ –æ –º–∏–≥—Ä–∞—Ü–∏–∏

6. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥** (`daily_parse.py`)
   - –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –Ω–æ–≤—ã—Ö –æ—Ç–∑—ã–≤–æ–≤
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ cron (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç)
   - **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å sync_branches** –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Ñ–∏–ª–∏–∞–ª–æ–≤
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –æ—Ç–∑—ã–≤–æ–≤
   - –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
   - –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤ –≤ –ë–î
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏

7. **Telegram Bot** (`telegram_bot.py`, `telegram_notifications.py`, `telegram_calendar.py`)
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –æ—Ç–∑—ã–≤–∞—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
   - –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å inline-–∫–Ω–æ–ø–∫–∞–º–∏
   - –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ñ–∏–ª–∏–∞–ª—ã —Å —Ñ—É–Ω–∫—Ü–∏–µ–π "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –≤—Å–µ"
   - –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç–∑—ã–≤–æ–≤ –∑–∞ –ø–µ—Ä–∏–æ–¥ —Å –≤—ã–±–æ—Ä–æ–º –¥–∞—Ç —á–µ—Ä–µ–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—å
   - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ)
   - –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –∏–∑ –æ—Ç–∑—ã–≤–æ–≤ (–æ–¥–∏–Ω–æ—á–Ω—ã–µ –∏ –∞–ª—å–±–æ–º—ã)
   - –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –ë–î
   - –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–π
   - –£–ª—É—á—à–µ–Ω–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è —Å –∫–Ω–æ–ø–∫–∞–º–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞

7–∞. **–ú–æ–¥—É–ª—å –∞–Ω–∞–ª–∏—Ç–∏–∫–∏** (`telegram_analytics.py`) üÜï
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ –¥–ª—è —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π —Ñ–∏–ª–∏–∞–ª–æ–≤
   - –ì—Ä–∞—Ñ–∏–∫ –¥–∏–Ω–∞–º–∏–∫–∏ —Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–µ–π—Ç–∏–Ω–≥–∞ –ø–æ –¥–Ω—è–º/–Ω–µ–¥–µ–ª—è–º/–º–µ—Å—è—Ü–∞–º
   - –ì—Ä–∞—Ñ–∏–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—Ç–∑—ã–≤–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π
   - –ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Ç–∑—ã–≤–æ–≤ –ø–æ –æ—Ü–µ–Ω–∫–∞–º
   - –¢–µ–∫—Å—Ç–æ–≤—ã–µ –æ—Ç—á–µ—Ç—ã —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –ø–µ—Ä–∏–æ–¥–∞–º–∏
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∞
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

8. **–û—á–µ—Ä–µ–¥—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** (`telegram_queue.py`, `telegram_notifications_queue.py`)
   - Redis + Celery –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
   - Rate limiting 30 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å–µ–∫—É–Ω–¥—É (—Å–æ–±–ª—é–¥–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ Telegram API)
   - Retry –ª–æ–≥–∏–∫–∞ —Å exponential backoff –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –æ—á–µ—Ä–µ–¥—å –¥–ª—è —Å—Ä–æ—á–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
   - Systemd —Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–æ—Ä–∫–µ—Ä–æ–º
   - –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å: —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ —Å–±–æ—è—Ö

9. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** (`cache_manager.py`)
   - Redis –∫—ç—à –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è API –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ 5.77 —Ä–∞–∑
   - **–¢—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è:**
     - branches_loader –∫—ç—à (TTL 5 –º–∏–Ω—É—Ç) - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
     - Redis –∫—ç—à - –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö —Ñ–∏–ª–∏–∞–ª–æ–≤/–æ—Ç–∑—ã–≤–æ–≤
     - API –∫—ç—à - –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö —Ñ–∏–ª–∏–∞–ª–æ–≤/–æ—Ç–∑—ã–≤–æ–≤
   - **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è** –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Ñ–∏–ª–∏–∞–ª–æ–≤ –∏ –æ—Ç–∑—ã–≤–æ–≤
   - TTL –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö (15 –º–∏–Ω - 2 —á–∞—Å–∞)
   - Graceful fallback –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Redis
   - API endpoints –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—ç—à–µ–º (/api/v1/cache/*)

10. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - –í—Å–µ —Ç–æ–∫–µ–Ω—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
   - CORS –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏
   - –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (96% –ø–æ–∫—Ä—ã—Ç–∏—è)
   - –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –ø–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é
   - –ê–ª–µ—Ä—Ç—ã –∏ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## üåê –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –î–æ–º–µ–Ω
- **Production URL**: https://reviews.aqniet.site
- **SSL**: Let's Encrypt (–¥–æ 2025-10-07)
- **Nginx**: Reverse proxy –≤ host network mode

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL 15 –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- **API —Å–µ—Ä–≤–µ—Ä**: Python 3.11 + FastAPI + uvicorn
- **Systemd**: reviews-api.service –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
- **Nginx**: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `/root/projects/hr-miniapp/nginx.conf`

### –ü–æ—Ä—Ç—ã
- **8004** - API —Å–µ—Ä–≤–µ—Ä
- **5436** - PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **6379** - Redis (–∫—ç—à –∏ –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π)

## üìä API Endpoints

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
- `GET /` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± API
- `GET /health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
- `GET /docs` - Swagger UI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `GET /redoc` - ReDoc –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### API v1
- `GET /api/v1/branches` - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ñ–∏–ª–∏–∞–ª–æ–≤
- `GET /api/v1/branches/{branch_id}/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ñ–∏–ª–∏–∞–ª–∞
- `GET /api/v1/reviews` - –û—Ç–∑—ã–≤—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- `GET /api/v1/reviews/{review_id}` - –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ—Ç–∑—ã–≤
- `GET /api/v1/stats` - –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `GET /api/v1/stats/recent` - –ù–µ–¥–∞–≤–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- `GET /api/v1/{branch_id}/{count}` - –ü–æ—Å–ª–µ–¥–Ω–∏–µ N –æ—Ç–∑—ã–≤–æ–≤ –ø–æ ID —Ñ–∏–ª–∏–∞–ª–∞
- `GET /api/v1/by-iiko/{id_iiko}/{count}` - –ü–æ—Å–ª–µ–¥–Ω–∏–µ N –æ—Ç–∑—ã–≤–æ–≤ –ø–æ iiko ID

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- `branch_id` - ID —Ñ–∏–ª–∏–∞–ª–∞
- `branch_name` - –ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª–∏–∞–ª–∞
- `rating` - –†–µ–π—Ç–∏–Ω–≥ (1-5)
- `verified_only` - –¢–æ–ª—å–∫–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ
- `date_from/date_to` - –î–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç
- `search` - –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É
- `sort_by` - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
- `order` - –ü–æ—Ä—è–¥–æ–∫ (asc/desc)
- `skip/limit` - –ü–∞–≥–∏–Ω–∞—Ü–∏—è

### –ü–æ–ª—è –æ—Ç–≤–µ—Ç–∞ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏
–ö–∞–∂–¥—ã–π –æ—Ç–∑—ã–≤ —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç:
- `photos_count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- `photos_urls` - –º–∞—Å—Å–∏–≤ URL —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Environment Variables (.env)
```env
DATABASE_URL=postgresql://reviews_user:reviews_password@localhost:5436/reviews_db
API_HOST=0.0.0.0
API_PORT=8004
PARSER_API_KEY=6e7e1929-4ea9-4a5d-8c05-d601860389bd
TELEGRAM_BOT_TOKEN=8109477829:AAFacevlPz4uJA9EH4ezOGBw9B3Rf5kl5xA
```

### Google Sheets Integration üÜï
- **Spreadsheet ID**: `13przZzgeCQay1dhunOuMtGc-_lV6y_xGrNOtCoG3ssQ`
- **Service Account**: `sheets-editor@basic-zenith-465712-s5.iam.gserviceaccount.com`
- **Key File**: `basic-zenith-465712-s5-63bf748b2e1c.json` (–≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞)
- **Scopes**: `https://www.googleapis.com/auth/spreadsheets.readonly`
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: 5 –º–∏–Ω—É—Ç (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ `branches_loader.py`)

### Nginx Configuration
‚ö†Ô∏è **–í–ê–ñ–ù–û**: Nginx —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ host network mode, –ø–æ—ç—Ç–æ–º—É –≤—Å–µ upstream-—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `127.0.0.1` –≤–º–µ—Å—Ç–æ –∏–º–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:
```nginx
proxy_pass http://127.0.0.1:8004;  # –ù–ï http://reviews-api:8004
```

## üöÄ –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ó–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
# API —Å–µ—Ä–≤–∏—Å
systemctl start reviews-api.service
systemctl stop reviews-api.service
systemctl restart reviews-api.service
systemctl status reviews-api.service

# Telegram Bot
systemctl start telegram-bot.service
systemctl stop telegram-bot.service
systemctl restart telegram-bot.service
systemctl status telegram-bot.service

# Telegram Queue (–æ—á–µ—Ä–µ–¥—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)
systemctl start telegram-queue.service
systemctl stop telegram-queue.service
systemctl restart telegram-queue.service
systemctl status telegram-queue.service
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
# API —Å–µ—Ä–≤–∏—Å
journalctl -u reviews-api.service -f

# Telegram Bot
journalctl -u telegram-bot.service -f

# Telegram Queue
journalctl -u telegram-queue.service -f
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
docker exec -it reviews-db psql -U reviews_user -d reviews_db

# Backup
docker exec reviews-db pg_dump -U reviews_user reviews_db > backup.sql

# Restore
docker exec -i reviews-db psql -U reviews_user reviews_db < backup.sql
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥
```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ (–æ–¥–∏–Ω —Ä–∞–∑)
./setup_cron.sh

# –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞
source venv/bin/activate
python daily_parse.py

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞
tail -f logs/cron.log
tail -f logs/daily_parse_*.log
```

### Telegram Bot
```bash
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
source venv/bin/activate
python telegram_notifications.py

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
source venv/bin/activate
python telegram_bot.py
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ cron –∑–∞–¥–∞–Ω–∏—è–º–∏
```bash
crontab -l                    # –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–∏—Ö –∑–∞–¥–∞–Ω–∏–π
crontab -e                    # –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
./run_daily_parse.sh          # –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ wrapper
```

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è API
```bash
curl https://reviews.aqniet.site/health
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ
```bash
curl http://127.0.0.1:8004/health
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å 502 Bad Gateway
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞: `systemctl status reviews-api.service`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç: `netstat -tlnp | grep 8004`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å firewall: `ufw status`
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å nginx logs: `docker logs hr-nginx`

## üìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã

- **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤**: 18,861+
- **–û—Ç–∑—ã–≤–æ–≤ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏**: 2,642+ (14.1%)
- **–ê–∫—Ç–∏–≤–Ω—ã—Ö —Ñ–∏–ª–∏–∞–ª–æ–≤**: 27 –∏–∑ 27 (–∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ Google Sheets)
- **Google Sheets Integration**: ‚úÖ –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ fallback
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥**: ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç) —Å Google Sheets
- **–ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥**: ‚úÖ –ù–æ–≤—ã–µ —Ñ–∏–ª–∏–∞–ª—ã –ø–∞—Ä—Å—è—Ç—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏
- **Telegram Bot**: ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω —Å –≥–ª–∞–≤–Ω—ã–º –º–µ–Ω—é –∏ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º + Google Sheets
- **–§—É–Ω–∫—Ü–∏—è "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –≤—Å–µ"**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å**: ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω
- **–ú–æ–¥—É–ª—å –∞–Ω–∞–ª–∏—Ç–∏–∫–∏**: ‚úÖ –í–∏–∑—É–∞–ª—å–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏ –æ—Ç—á–µ—Ç—ã –¥–ª—è —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π üÜï
- **–û—á–µ—Ä–µ–¥—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**: ‚úÖ Redis + Celery (30 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫) —Å –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å—é
- **–¢—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: ‚úÖ –¢–æ–∫–µ–Ω—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π CORS, security –∑–∞–≥–æ–ª–æ–≤–∫–∏
- **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**: ‚úÖ Graceful fallback, –∞–≤—Ç–æ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ, CSV fallback
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: ‚úÖ 13 —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤, –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ üÜï
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –∏ –∞–ª–µ—Ä—Ç—ã
- **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2025-07-14

## üìã TODO / –£–ª—É—á—à–µ–Ω–∏—è

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
   - –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ —Å–±–æ—è—Ö –ø–∞—Ä—Å–∏–Ω–≥–∞
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –æ—Ç–∑—ã–≤–∞—Ö

2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
   - –î–æ–±–∞–≤–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –¥–ª—è API
   - Rate limiting –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î

4. **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**
   - –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
   - –ê–Ω–∞–ª–∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π –≤ –æ—Ç–∑—ã–≤–∞—Ö
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- PostgreSQL –ø–∞—Ä–æ–ª—å —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ environment variables
- SSL/TLS —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Let's Encrypt
- CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –≤—Å–µ—Ö –¥–æ–º–µ–Ω–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å)
- Rate limiting —á–µ—Ä–µ–∑ nginx
- Firewall –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è Docker —Å–µ—Ç–∏

## üìù –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
/root/projects/reviews-parser/
‚îú‚îÄ‚îÄ api_v2.py                    # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
‚îú‚îÄ‚îÄ database.py                  # SQLAlchemy –º–æ–¥–µ–ª–∏ (—Å –ø–æ–ª—è–º–∏ –¥–ª—è —Ñ–æ—Ç–æ –∏ Telegram)
‚îú‚îÄ‚îÄ parser.py                    # –ü–∞—Ä—Å–µ—Ä 2GIS (—Å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π)
‚îú‚îÄ‚îÄ branches_loader.py           # üÜï –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∑–∞–≥—Ä—É–∑—á–∏–∫ —Ñ–∏–ª–∏–∞–ª–æ–≤ –∏–∑ Google Sheets
‚îú‚îÄ‚îÄ sync_branches.py             # üÜï –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ñ–∏–ª–∏–∞–ª–æ–≤ —Å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–º –ø–∞—Ä—Å–∏–Ω–≥–æ–º –Ω–æ–≤—ã—Ö
‚îú‚îÄ‚îÄ daily_parse.py               # –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç)
‚îú‚îÄ‚îÄ telegram_bot.py              # Telegram Bot –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îú‚îÄ‚îÄ telegram_calendar.py         # –ö–∞–ª–µ–Ω–¥–∞—Ä—å –¥–ª—è –≤—ã–±–æ—Ä–∞ –¥–∞—Ç
‚îú‚îÄ‚îÄ telegram_notifications.py    # –ú–æ–¥—É–ª—å –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îú‚îÄ‚îÄ telegram_analytics.py        # üÜï –ú–æ–¥—É–ª—å –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤
‚îú‚îÄ‚îÄ setup_cron.sh                # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞
‚îú‚îÄ‚îÄ run_daily_parse.sh           # Wrapper –¥–ª—è cron
‚îú‚îÄ‚îÄ migrate_to_db.py             # –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ migrate_to_google_sheets.py  # üÜï –°–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ CSV –≤ Google Sheets
‚îú‚îÄ‚îÄ parse_sandyq_tary.py         # –ü–∞—Ä—Å–∏–Ω–≥ –≤—Å–µ—Ö —Ñ–∏–ª–∏–∞–ª–æ–≤ (–æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è Google Sheets)
‚îú‚îÄ‚îÄ analyze_reviews.py           # –ê–Ω–∞–ª–∏–∑ –æ—Ç–∑—ã–≤–æ–≤
‚îú‚îÄ‚îÄ requirements.txt             # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (+ google-api-python-client, gspread)
‚îú‚îÄ‚îÄ .env                         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (+ TELEGRAM_BOT_TOKEN)
‚îú‚îÄ‚îÄ docker-compose.yml           # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile                   # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ basic-zenith-465712-s5-63bf748b2e1c.json # üÜï –ö–ª—é—á —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ Google
‚îú‚îÄ‚îÄ reviews-api.service          # Systemd —Å–µ—Ä–≤–∏—Å –¥–ª—è API
‚îú‚îÄ‚îÄ telegram-bot.service         # Systemd —Å–µ—Ä–≤–∏—Å –¥–ª—è Telegram Bot
‚îú‚îÄ‚îÄ setup_deployment.sh          # –°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏
‚îú‚îÄ‚îÄ nginx-reviews.conf           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è nginx
‚îú‚îÄ‚îÄ CLAUDE.md                    # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ (–æ–±–Ω–æ–≤–ª–µ–Ω–∞)
‚îú‚îÄ‚îÄ TESTING_REPORT.md            # –û—Ç—á–µ—Ç –æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
‚îú‚îÄ‚îÄ MONITORING_GUIDE.md          # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É
‚îú‚îÄ‚îÄ setup_security_and_queue.md # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –æ—á–µ—Ä–µ–¥–∏
‚îú‚îÄ‚îÄ telegram_queue.py            # –ú–æ–¥—É–ª—å –æ—á–µ—Ä–µ–¥–∏ Celery –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îú‚îÄ‚îÄ telegram_notifications_queue.py  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å
‚îú‚îÄ‚îÄ cache_manager.py             # –ú–µ–Ω–µ–¥–∂–µ—Ä –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è Redis
‚îú‚îÄ‚îÄ telegram-queue.service       # Systemd —Å–µ—Ä–≤–∏—Å –¥–ª—è –≤–æ—Ä–∫–µ—Ä–∞ –æ—á–µ—Ä–µ–¥–∏
‚îú‚îÄ‚îÄ .env.example                 # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ test_full_system.py          # –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
‚îú‚îÄ‚îÄ test_bot.py                  # –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –±–æ—Ç–∞
‚îú‚îÄ‚îÄ test_buttons.py              # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ callback_data
‚îú‚îÄ‚îÄ test_subscriptions.py        # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø–æ–¥–ø–∏—Å–æ–∫
‚îú‚îÄ‚îÄ test_select_all.py           # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –≤—Å–µ"
‚îú‚îÄ‚îÄ test_error_handling.py       # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ test_security_and_improvements.py  # –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏–π
‚îú‚îÄ‚îÄ test_telegram_queue_detailed.py    # –î–µ—Ç–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏
‚îú‚îÄ‚îÄ test_failover_scenarios.py   # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ test_cache_performance.py    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫—ç—à–∞
‚îú‚îÄ‚îÄ test_cors_detailed.py        # –î–µ—Ç–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ CORS
‚îú‚îÄ‚îÄ test_analytics.py            # üÜï –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
‚îú‚îÄ‚îÄ test_telegram_analytics.py   # üÜï –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ —Å –±–æ—Ç–æ–º
‚îú‚îÄ‚îÄ test_calendar_behavior.py    # üÜï –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
‚îú‚îÄ‚îÄ ANALYTICS_DOCUMENTATION.md   # üÜï –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –º–æ–¥—É–ª—é –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
‚îú‚îÄ‚îÄ CALENDAR_IMPROVEMENTS.md     # üÜï –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —É–ª—É—á—à–µ–Ω–∏–π –∫–∞–ª–µ–Ω–¥–∞—Ä—è
‚îú‚îÄ‚îÄ data/                        # –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îî‚îÄ‚îÄ sandyq_tary_branches.csv # –°–ø–∏—Å–æ–∫ —Ñ–∏–ª–∏–∞–ª–æ–≤ (fallback –¥–ª—è Google Sheets)
‚îú‚îÄ‚îÄ logs/                        # –õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ cron.log                 # –õ–æ–≥–∏ cron –∑–∞–¥–∞–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ daily_parse_*.log        # –õ–æ–≥–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞
‚îî‚îÄ‚îÄ output/                      # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞
    ‚îú‚îÄ‚îÄ reviews_*.csv
    ‚îî‚îÄ‚îÄ reviews_*.json
```

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `journalctl -u reviews-api.service -n 100`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ë–î: `docker ps | grep reviews-db`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å nginx: `docker logs hr-nginx --tail 50`
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥: `tail -f logs/cron.log`
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –¥–ª—è —Ä–µ—à–µ–Ω–∏—è —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

## üîó –ü—Ä–∏–º–µ—Ä—ã API –∑–∞–ø—Ä–æ—Å–æ–≤

### –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏:
```bash
curl "https://reviews.aqniet.site/api/v1/reviews?branch_id=70000001067929337&limit=10" | jq '.[] | select(.photos_count > 0)'
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ñ–∏–ª–∏–∞–ª—É:
```bash
curl "https://reviews.aqniet.site/api/v1/branches/70000001067929337/stats" | jq .
```

### –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã:
```bash
curl "https://reviews.aqniet.site/api/v1/stats" | jq .
```

### –ü–æ—Å–ª–µ–¥–Ω–∏–µ N –æ—Ç–∑—ã–≤–æ–≤ –ø–æ ID —Ñ–∏–ª–∏–∞–ª–∞:
```bash
curl "https://reviews.aqniet.site/api/v1/70000001067929337/100" | jq '.[0:3]'
```

### –ü–æ—Å–ª–µ–¥–Ω–∏–µ N –æ—Ç–∑—ã–≤–æ–≤ –ø–æ iiko ID:
```bash
curl "https://reviews.aqniet.site/api/v1/by-iiko/700917ce-77e5-479a-a4a9-68c2a9e76fc2/50" | jq '.[0:3]'
```

## üì± Telegram Bot

### –ö–æ–º–∞–Ω–¥—ã
- `/start` - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π
- `/unsubscribe` - –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –≥–ª–∞–≤–Ω–æ–º—É –º–µ–Ω—é
- `/reviews` - –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –≥–ª–∞–≤–Ω–æ–º—É –º–µ–Ω—é

### –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- **üìä –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç–∑—ã–≤–æ–≤** - –í—ã–±–æ—Ä —Ñ–∏–ª–∏–∞–ª–∞ –∏ –ø–µ—Ä–∏–æ–¥ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
- **üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** - –í–∏–∑—É–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –¥–ª—è —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π üÜï
- **üìù –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏** - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–æ–∫
- **üîî –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –î–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **‚ÑπÔ∏è –ü–æ–º–æ—â—å** - –°–ø—Ä–∞–≤–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –§—É–Ω–∫—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–æ–∫
- **‚úÖ –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –≤—Å–µ** - –í—ã–±–æ—Ä –≤—Å–µ—Ö 23 —Ñ–∏–ª–∏–∞–ª–æ–≤ –æ–¥–Ω–∏–º –Ω–∞–∂–∞—Ç–∏–µ–º
- **‚ùå –û—Ç–ø–∏—Å–∞—Ç—å—Å—è –æ—Ç –≤—Å–µ—Ö** - –ú–∞—Å—Å–æ–≤–∞—è –æ—Ç–ø–∏—Å–∫–∞
- **Toggle-–∫–Ω–æ–ø–∫–∏** - –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä —Ñ–∏–ª–∏–∞–ª–æ–≤ —Å –≥–∞–ª–æ—á–∫–∞–º–∏
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö** - –ù–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∫ —Å—Ç–∞—Ä—ã–º
- **–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –ü–æ–∫–∞–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–æ–∫

### –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –æ—Ç–∑—ã–≤–æ–≤
- **–í—ã–±–æ—Ä —Ñ–∏–ª–∏–∞–ª–∞** - –ò–∑ —Å–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫
- **–î–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç** - –í—ã–±–æ—Ä —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å
- **–ö–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ** - –£–¥–æ–±–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –º–µ—Å—è—Ü–∞–º
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–µ—Ä–∏–æ–¥–∞** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞—Ç
- **–ü–∞–≥–∏–Ω–∞—Ü–∏—è** - –ü–æ 5 –æ—Ç–∑—ã–≤–æ–≤ –∑–∞ —Ä–∞–∑
- **–ö–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç—å –µ—â—ë"** - –î–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤
- **–ö–Ω–æ–ø–∫–∞ "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"** - –ë—ã—Å—Ç—Ä—ã–π –≤–æ–∑–≤—Ä–∞—Ç –∏–∑ –ª—é–±–æ–≥–æ –º–µ—Å—Ç–∞
- **–ö–Ω–æ–ø–∫–∞ "–í—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π –ø–µ—Ä–∏–æ–¥"** - –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –æ—Ç–∑—ã–≤–æ–≤

### –§—É–Ω–∫—Ü–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ üÜï
- **–í—ã–±–æ—Ä —Ñ–∏–ª–∏–∞–ª–∞** - –ò–∑ —Å–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫
- **–î–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç** - –í—ã–±–æ—Ä —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å
- **–ì—Ä–∞—Ñ–∏–∫ –¥–∏–Ω–∞–º–∏–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞** - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–µ–π—Ç–∏–Ω–≥–∞ –ø–æ –¥–Ω—è–º
- **–ì—Ä–∞—Ñ–∏–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—Ç–∑—ã–≤–æ–≤** - –î–∏–Ω–∞–º–∏–∫–∞ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –æ—Ç–∑—ã–≤–æ–≤
- **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –æ—Ü–µ–Ω–∫–∞–º** - –ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö/–Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤
- **–¢–µ–∫—Å—Ç–æ–≤–∞—è —Å–≤–æ–¥–∫–∞** - –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
- **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –ø–µ—Ä–∏–æ–¥–æ–º** - –ê–Ω–∞–ª–∏–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏** - –ù–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤

### –£–ª—É—á—à–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
- **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è** - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `telegram_user_states`
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** - –ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Å—Å–∏–∏
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ—à–∏–±–æ–∫
- **Callback_data –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - –°–æ–±–ª—é–¥–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞ 64 –±–∞–π—Ç–∞
- **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** - Graceful degradation –ø—Ä–∏ —Å–±–æ—è—Ö

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- `telegram_users` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Telegram
- `telegram_subscriptions` - –ü–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Ñ–∏–ª–∏–∞–ª—ã
- `telegram_user_states` - –°–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (JSON)
- `reviews.sent_to_telegram` - –§–ª–∞–≥ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram

### –§–æ—Ä–º–∞—Ç—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
```
üì¢ –ù–æ–≤—ã–π –æ—Ç–∑—ã–≤ –¥–ª—è —Ñ–∏–ª–∏–∞–ª–∞ {branch_name}:
üë§ –ê–≤—Ç–æ—Ä: {user_name}
‚≠ê –†–µ–π—Ç–∏–Ω–≥: {rating_stars} ({rating}/5)
üìù –¢–µ–∫—Å—Ç: {text}
üìÖ –î–∞—Ç–∞: {date_created}
```

### –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- **–û–¥–∏–Ω–æ—á–Ω—ã–µ —Ñ–æ—Ç–æ** - –û—Ç–ø—Ä–∞–≤–∫–∞ —Å caption
- **–ê–ª—å–±–æ–º—ã** - –î–æ 10 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –≤ –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø–µ
- **Fallback** - –¢–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è callback_data** - –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Å 74 –¥–æ 25 —Å–∏–º–≤–æ–ª–æ–≤
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Button_data_invalid** - –°–æ–±–ª—é–¥–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞ 64 –±–∞–π—Ç–∞
- **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ
- **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
- **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö** - –í—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ PostgreSQL
- **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** - Graceful degradation –ø—Ä–∏ —Å–±–æ—è—Ö
- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å** - –ó–∞–º–µ–Ω–∞ —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –¥–∞—Ç –Ω–∞ –≤—ã–±–æ—Ä —á–µ—Ä–µ–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—å
- **–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—é** - –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –º–µ—Å—è—Ü–∞–º–∏
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞—Ç** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–µ—Ä–∏–æ–¥–∞

### –§–∞–π–ª—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- `test_full_system.py` - –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
- `test_bot.py` - –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –±–æ—Ç–∞
- `test_buttons.py` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ callback_data
- `test_subscriptions.py` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø–æ–¥–ø–∏—Å–æ–∫
- `test_select_all.py` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –≤—Å–µ"
- `test_error_handling.py` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

---
–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2025-07-14 16:00  
–í–µ—Ä—Å–∏—è: 2.9.1 (—É–ª—É—á—à–µ–Ω–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ - –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å)